<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>husky_components/input/main.js - husky</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title="husky"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.1.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/AutoComplete.html">AutoComplete</a></li>
            
                <li><a href="../classes/AutoCompleteList.html">AutoCompleteList</a></li>
            
                <li><a href="../classes/CKEditor.html">CKEditor</a></li>
            
                <li><a href="../classes/Column-Options.html">Column-Options</a></li>
            
                <li><a href="../classes/ColumnNavigation.html">ColumnNavigation</a></li>
            
                <li><a href="../classes/DataGrid.html">DataGrid</a></li>
            
                <li><a href="../classes/Dependant Select.html">Dependant Select</a></li>
            
                <li><a href="../classes/DropdownPagination (Datagrid Decorator).html">DropdownPagination (Datagrid Decorator)</a></li>
            
                <li><a href="../classes/Dropzone.html">Dropzone</a></li>
            
                <li><a href="../classes/GroupView (Datagrid Decorator).html">GroupView (Datagrid Decorator)</a></li>
            
                <li><a href="../classes/Input.html">Input</a></li>
            
                <li><a href="../classes/Label.html">Label</a></li>
            
                <li><a href="../classes/Loader.html">Loader</a></li>
            
                <li><a href="../classes/Matcher.html">Matcher</a></li>
            
                <li><a href="../classes/Overlay.html">Overlay</a></li>
            
                <li><a href="../classes/Process.html">Process</a></li>
            
                <li><a href="../classes/Search.html">Search</a></li>
            
                <li><a href="../classes/Select.html">Select</a></li>
            
                <li><a href="../classes/ShowAllPagination (Datagrid Decorator).html">ShowAllPagination (Datagrid Decorator)</a></li>
            
                <li><a href="../classes/SmartContent.html">SmartContent</a></li>
            
                <li><a href="../classes/TableView (Datagrid Decorator).html">TableView (Datagrid Decorator)</a></li>
            
                <li><a href="../classes/Tabs.html">Tabs</a></li>
            
                <li><a href="../classes/ThumbnailView (Datagrid Decorator).html">ThumbnailView (Datagrid Decorator)</a></li>
            
                <li><a href="../classes/Toggler.html">Toggler</a></li>
            
                <li><a href="../classes/Toolbar.html">Toolbar</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/husky_components_auto-complete.html">husky/components/auto-complete</a></li>
            
                <li><a href="../modules/husky_components_auto-complete-list.html">husky/components/auto-complete-list</a></li>
            
                <li><a href="../modules/husky_components_column-navigation.html">husky/components/column-navigation</a></li>
            
                <li><a href="../modules/husky_components_column-options.html">husky/components/column-options</a></li>
            
                <li><a href="../modules/husky_components_dropzone.html">husky/components/dropzone</a></li>
            
                <li><a href="../modules/husky_components_input.html">husky/components/input</a></li>
            
                <li><a href="../modules/husky_components_label.html">husky/components/label</a></li>
            
                <li><a href="../modules/husky_components_matcher.html">husky/components/matcher</a></li>
            
                <li><a href="../modules/husky_components_overlay.html">husky/components/overlay</a></li>
            
                <li><a href="../modules/husky_components_process.html">husky/components/process</a></li>
            
                <li><a href="../modules/husky_components_smart-content.html">husky/components/smart-content</a></li>
            
                <li><a href="../modules/husky_components_toolbar.html">husky/components/toolbar</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: husky_components/input/main.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
 * This file is part of Husky frontend development framework.
 *
 * (c) MASSIVE ART WebServices GmbH
 *
 * This source file is subject to the MIT license that is bundled
 * with this source code in the file LICENSE.
 *
 * @module husky/components/input
 */

/**
 * @class Input
 * @constructor
 *
 * @params {Object} [options] Configuration object
 * @params {String} [options.instanceName] name if the the input instance
 * @params {String} [options.inputId] DOM-id to give the actual input-tag
 * @params {String} [options.inputName] DOM-name to give the actual input-tag. Can be usefull in forms
 * @params {String} [options.value] value to set at the beginning
 * @params {String} [options.placeholder] html5-placholder to use
 * @params {String} [options.skin] name of the skin to use. Currently &#x27;phone&#x27;, &#x27;password&#x27;, &#x27;url&#x27;, &#x27;email&#x27;, &#x27;date&#x27;, &#x27;time&#x27;, &#x27;color&#x27;. Each skin brings it&#x27;s own default values. For example the password skin has automatically inputType: &#x27;password&#x27;
 * @params {Object} [options.datepickerOptions] config-object to pass to the datepicker component
 * @params {Object} [options.colorPickerOptions] config-object to pass to the colorpicker component
 * @params {String} [options.frontIcon] name of icon to display in front
 * @params {String} [options.frontText] text to display in front
 * @params {String} [options.frontHtml] html to display in front
 * @params {String} [options.backIcon] name of icon to display in front
 * @params {String} [options.backText] text to display in back
 * @params {String} [options.backHtml] html to display in back
 * @params {String} [options.renderMethod] name of a special render method to execute. Currently &#x27;colorpicker&#x27;, &#x27;datepicker&#x27;, &#x27;time&#x27;. For example &#x27;colorpicker&#x27; initializes a colorpicker and sets a css-class
 * @params {String} [options.inputType] the actual type of the input. e.g. &#x27;text&#x27; or &#x27;password&#x27;
 */
define([], function () {

    &#x27;use strict&#x27;;

    var defaults = {
            instanceName: &#x27;undefined&#x27;,
            inputId: &#x27;&#x27;,
            inputName: &#x27;&#x27;,
            value: &#x27;&#x27;,
            placeholder: &#x27;&#x27;,
            skin: null,
            datepickerOptions: {},
            colorPickerOptions: {},
            frontIcon: null,
            frontText: null,
            frontHtml: null,
            backIcon: null,
            backText: null,
            backHtml: null,
            renderMethod: null,
            inputType: &#x27;text&#x27;
        },

        constants = {
            componentClass: &#x27;husky-input&#x27;,
            frontClass: &#x27;front&#x27;,
            backClass: &#x27;back&#x27;,
            textClass: &#x27;text&#x27;,
            inputClass: &#x27;input&#x27;,
            actionClass: &#x27;action&#x27;,
            colorFieldClass: &#x27;color-field&#x27;,
            colorpickerClass: &#x27;colorpicker&#x27;,
            datepickerClass: &#x27;pickdate&#x27;,
            linkClickableClass: &#x27;clickable&#x27;
        },

        templates = {
            input: &#x27;&lt;input type=&quot;&lt;%= type %&gt;&quot; value=&quot;&lt;%= value %&gt;&quot; placeholder=&quot;&lt;%= placeholder %&gt;&quot; id=&quot;&lt;%= id %&gt;&quot; name=&quot;&lt;%= name %&gt;&quot; data-from=&quot;false&quot;/&gt;&#x27;,
            colorPickerFront: &#x27;&lt;div class=&quot;&#x27;+ constants.colorFieldClass +&#x27;&quot;/&gt;&#x27;
        },

        renderMethods = {
            colorpicker: function() {
                this.renderColorPicker();
            },
            datepicker: function() {
                this.renderDatePicker();
            },
            time: function() {
                this.renderTime();
            },
            url: function () {
                this.renderLink(&#x27;http://&#x27;);
            },
            email: function () {
                this.renderLink(&#x27;mailto:&#x27;);
            }
        },

        skins = {
            color: {
                frontHtml: templates.colorPickerFront,
                renderMethod: &#x27;colorpicker&#x27;
            },
            phone: {
                frontIcon: &#x27;phone&#x27;
            },
            password: {
                frontIcon: &#x27;key&#x27;,
                inputType: &#x27;password&#x27;
            },
            url: {
                frontText: &#x27;http://&#x27;,
                renderMethod: &#x27;url&#x27;
            },
            email: {
                frontIcon: &#x27;envelope&#x27;,
                renderMethod: &#x27;email&#x27;
            },
            date: {
                frontIcon: &#x27;calendar&#x27;,
                placeholder: &#x27;TT - MM - JJJJ&#x27;,
                renderMethod: &#x27;datepicker&#x27;
            },
            time: {
                frontIcon: &#x27;clock-o&#x27;,
                placeholder: &#x27;HH - MM&#x27;,
                renderMethod: &#x27;time&#x27;
            }
        },

        /**
         * namespace for events
         * @type {string}
         */
            eventNamespace = &#x27;husky.input.&#x27;,

        /**
         * raised after initialization process
         * @event husky.input.&lt;instance-name&gt;.initialize
         */
            INITIALIZED = function () {
            return createEventName.call(this, &#x27;initialized&#x27;);
        },

        /** returns normalized event names */
            createEventName = function (postFix) {
            return eventNamespace + (this.options.instanceName ? this.options.instanceName + &#x27;.&#x27; : &#x27;&#x27;) + postFix;
        };

    return {

        /**
         * Initialize component
         */
        initialize: function () {
            this.sandbox.logger.log(&#x27;initialize&#x27;, this);
            var defaults = defaults;

            // merge skin defaults with defaults
            if (!!this.options.skin &amp;&amp; !!skins[this.options.skin]) {
                defaults = this.sandbox.util.extend(true, {}, defaults, skins[this.options.skin]);
            }
            // merge defaults, skin defaults and options
            this.options = this.sandbox.util.extend(true, {}, defaults, this.options);

            this.input = {
                $front: null,
                $input: null,
                $back: null
            };
            this.linkProtocol = null;

            this.render();
            this.bindDomEvents();

            this.sandbox.emit(INITIALIZED.call(this));
        },

        /**
         * Renders the input component
         */
        render: function() {
            this.sandbox.dom.addClass(this.$el, constants.componentClass);
            // add action class if an action is set
            if (!!this.options.action) {
                this.sandbox.dom.addClass(this.$el, constants.actionClass);
            }
            this.renderFront();
            this.renderInput();
            this.renderBack();
            // call a render method specific for the skin
            // e.g. renderColorPicker
            if (!!this.options.renderMethod &amp;&amp; !!renderMethods[this.options.renderMethod]) {
                renderMethods[this.options.renderMethod].call(this);
            }
        },

        /**
         * Binds Dom-related events
         */
        bindDomEvents: function() {
            this.sandbox.dom.on(this.$el, &#x27;click&#x27;, function() {
                this.sandbox.dom.focus(this.input.$input);
            }.bind(this));

            // delegate labels on input
            if(!!this.sandbox.dom.attr(this.$el, &#x27;id&#x27;)) {
                this.sandbox.dom.on(&#x27;label[for=&quot;&#x27;+ this.sandbox.dom.attr(this.$el, &#x27;id&#x27;) +&#x27;&quot;]&#x27;, &#x27;click&#x27;, function() {
                    this.sandbox.dom.focus(this.input.$input);
                }.bind(this));
            }

            // change the input value if the data attribute got changed
            this.sandbox.dom.on(this.$el, &#x27;data-changed&#x27;, function() {
                this.updateValue();
            }.bind(this));
        },

        /**
         * Renders the front of the input
         */
        renderFront: function() {
            if (!!this.options.frontIcon || !!this.options.frontText || !!this.options.frontHtml) {
                this.input.$front = this.sandbox.dom.createElement(&#x27;&lt;div class=&quot;&#x27;+ constants.frontClass +&#x27;&quot;/&gt;&#x27;);
                if (!!this.options.frontIcon) {
                    this.sandbox.dom.html(this.input.$front, &#x27;&lt;a class=&quot;fa-&#x27; + this.options.frontIcon + &#x27;&quot;&gt;&lt;/a&gt;&#x27;);
                } else if (!!this.options.frontText) {
                    this.sandbox.dom.html(this.input.$front, &#x27;&lt;a class=&quot;&#x27; + constants.textClass + &#x27;&quot;&gt;&#x27; + this.options.frontText + &#x27;&lt;/a&gt;&#x27;);
                } else {
                    this.sandbox.dom.html(this.input.$front, this.options.frontHtml);
                }
                this.sandbox.dom.append(this.$el, this.input.$front);
            }
        },

        /**
         * Renders the actual html-input field
         * with validation constraints and so on
         */
        renderInput: function() {
            var $container = this.sandbox.dom.createElement(&#x27;&lt;div class=&quot;&#x27;+ constants.inputClass +&#x27;&quot;/&gt;&#x27;);
            this.input.$input = this.sandbox.dom.createElement(this.sandbox.util.template(templates.input)({
                type: this.options.inputType,
                name: (!!this.options.inputName) ? this.options.inputName : &#x27;husky-input-&#x27; + this.options.instanceName,
                id: (!!this.options.inputId) ? this.options.inputId : &#x27;husky-input-&#x27; + this.options.instanceName,
                value: this.options.value,
                placeholder: this.options.placeholder
            }));
            this.sandbox.dom.append($container, this.input.$input);
            this.sandbox.dom.append(this.$el, $container);
        },

        /**
         * renders the back of the input
         */
        renderBack: function() {
            if (!!this.options.backIcon || !!this.options.backText || !!this.options.backHtml) {
                this.input.$back = this.sandbox.dom.createElement(&#x27;&lt;div class=&quot;&#x27;+ constants.backClass +&#x27;&quot;/&gt;&#x27;);
                if (!!this.options.backIcon) {
                    this.sandbox.dom.html(this.input.$back, &#x27;&lt;span class=&quot;fa-&#x27;+ this.options.backIcon +&#x27;&quot;&gt;&lt;/span&gt;&#x27;);
                } else if (!!this.options.backText) {
                    this.sandbox.dom.html(this.input.$back, &#x27;&lt;span class=&quot;&#x27;+ constants.textClass +&#x27;&quot;&gt;&#x27;+ this.options.backText +&#x27;&lt;/span&gt;&#x27;);
                } else {
                    this.sandbox.dom.html(this.input.$back, this.options.backHtml);
                }
                this.sandbox.dom.append(this.$el, this.input.$back);
            }
        },

        /**
         * Starts the colorpicker
         */
        renderColorPicker: function() {
            this.sandbox.dom.addClass(this.$el, constants.colorpickerClass);
            this.changeColorPreview(this.sandbox.dom.val(this.input.$input));
            this.sandbox.colorpicker.init(this.input.$input, this.sandbox.util.extend(true, {}, {
                defaultValue: this.sandbox.dom.val(this.input.$input),
                change: this.changeColorPreview.bind(this)
            }, this.options.colorPickerOptions));
        },

        /**
         * Starts the datepicker
         */
        renderDatePicker: function() {
            this.sandbox.dom.addClass(this.$el, constants.datepickerClass);
            this.sandbox.dom.attr(this.input.$input, &#x27;placeholder&#x27;, this.sandbox.globalize.getDatePattern());
            this.sandbox.datepicker.init(this.input.$input, this.options.datepickerOptions).on(&#x27;changeDate&#x27;, function(event) {
                this.setDatepickerValueAttr(event.date);
            }.bind(this));
            this.updateValue();

            this.bindDatepickerDomEvents();
        },

        /**
         * Attaches an event-listner to the input which makes an a-tag with clickable
         * @param protocol {String} a protocol to prepend to the input-value (e.g. &#x27;http://&#x27; or &#x27;mailto:&#x27;)
         */
        renderLink: function (protocol) {
            this.linkProtocol = protocol;
            this.sandbox.dom.on(this.input.$input, &#x27;keyup&#x27;, this.changeFrontLink.bind(this));
            this.changeFrontLink();
        },

        /**
         * Changes the anchor-tag in the front-section
         */
        changeFrontLink: function() {
            var value = this.sandbox.dom.val(this.input.$input);
            if (!!value) {
                this.sandbox.dom.addClass(this.sandbox.dom.find(&#x27;a&#x27;, this.input.$front), constants.linkClickableClass);
                this.sandbox.dom.attr(this.sandbox.dom.find(&#x27;a&#x27;, this.input.$front), &#x27;href&#x27;, this.linkProtocol + value);
                if (this.linkProtocol.indexOf(&#x27;mailto&#x27;) &lt; 0) {
                    this.sandbox.dom.attr(this.sandbox.dom.find(&#x27;a&#x27;, this.input.$front), &#x27;target&#x27;, &#x27;_blank&#x27;);
                }
            } else {
                this.sandbox.dom.removeClass(this.sandbox.dom.find(&#x27;a&#x27;, this.input.$front), constants.linkClickableClass);
                this.sandbox.dom.removeAttr(this.sandbox.dom.find(&#x27;a&#x27;, this.input.$front), &#x27;href&#x27;);
            }
        },

        /**
         * Binds Dom-events for the datepicker
         */
        bindDatepickerDomEvents: function() {
            this.sandbox.dom.on(this.input.$input, &#x27;focusout&#x27;, function() {
                this.setDatepickerValueAttr(this.sandbox.datepicker.getDate(this.input.$input));
            }.bind(this));
        },

        /**
         * Renders time specific things
         */
        renderTime: function() {
            this.sandbox.dom.attr(this.input.$input, &#x27;placeholder&#x27;, this.sandbox.globalize.getTimePatter());
        },

        /**
         * Updates the square which shows the current color for the colorpicker
         * @param color {String} new hex color
         */
        changeColorPreview: function(color) {
            this.sandbox.dom.css(this.$find(&#x27;.&#x27; + constants.colorFieldClass), {
                &#x27;background-color&#x27;: color
            });
        },

        /**
         * Sets the input value
         * @param value {String} new value
         */
        setValue: function(value) {
            if (this.options.renderMethod === &#x27;colorpicker&#x27;) {
                if (!!value) {
                    this.sandbox.colorpicker.value(this.input.$input, value);
                } else {
                    this.sandbox.dom.val(this.input.$input, value);
                }
            } else if (this.options.renderMethod === &#x27;datepicker&#x27;) {
                // if a date-time was passed, extract the date
                if (!!value) {
                    value = this.isoToDate(value);
                    value = new Date(value);
                }
                this.sandbox.datepicker.setDate(this.input.$input, value);
                this.setDatepickerValueAttr(this.sandbox.datepicker.getDate(this.input.$input));
            } else {
                this.sandbox.dom.val(this.input.$input, value);
                if (this.options.renderMethod === &#x27;email&#x27; || this.options.renderMethod === &#x27;url&#x27;) {
                    this.changeFrontLink();
                }
            }
        },

        /**
         * Takes a iso date-time string and returns only the date part
         * @param datetime {String} iso-datetime-string
         */
        isoToDate: function(datetime) {
            if (datetime.indexOf(&#x27;T&#x27;) &gt; 0) {
                return datetime.substr(0, datetime.indexOf(&#x27;T&#x27;));
            }
            return datetime;
        },

        /**
         * Sets the value attribute for the datepicker
         * @param date {Object} a UTC date pbject
         */
        setDatepickerValueAttr: function(date) {
            if (!!date) {
                if (this.sandbox.dom.isNumeric(date.valueOf())) {
                    date = date.getFullYear() + &#x27;-&#x27; +
                        (&#x27;0&#x27; + (date.getMonth()+1)).slice(-2) + &#x27;-&#x27; +
                        (&#x27;0&#x27; + date.getDate()).slice(-2);
                } else {
                    date = &#x27;&#x27;;
                    this.sandbox.dom.val(this.input.$input, &#x27;&#x27;);
                }
            }
            this.sandbox.dom.data(this.$el, &#x27;value&#x27;, date);
        },

        /**
         * Updates the value with what is in the
         * data attribute
         */
        updateValue: function() {
            this.setValue(this.sandbox.dom.data(this.$el, &#x27;value&#x27;));
        }
    };

});

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
