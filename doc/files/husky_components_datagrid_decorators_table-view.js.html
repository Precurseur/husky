<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>husky_components/datagrid/decorators/table-view.js - husky</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title="husky"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.1.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/AutoComplete.html">AutoComplete</a></li>
            
                <li><a href="../classes/AutoCompleteList.html">AutoCompleteList</a></li>
            
                <li><a href="../classes/CKEditor.html">CKEditor</a></li>
            
                <li><a href="../classes/Column-Options.html">Column-Options</a></li>
            
                <li><a href="../classes/ColumnNavigation.html">ColumnNavigation</a></li>
            
                <li><a href="../classes/DataGrid.html">DataGrid</a></li>
            
                <li><a href="../classes/Dependant Select.html">Dependant Select</a></li>
            
                <li><a href="../classes/DropdownPagination (Datagrid Decorator).html">DropdownPagination (Datagrid Decorator)</a></li>
            
                <li><a href="../classes/Dropzone.html">Dropzone</a></li>
            
                <li><a href="../classes/GroupView (Datagrid Decorator).html">GroupView (Datagrid Decorator)</a></li>
            
                <li><a href="../classes/Input.html">Input</a></li>
            
                <li><a href="../classes/Label.html">Label</a></li>
            
                <li><a href="../classes/Loader.html">Loader</a></li>
            
                <li><a href="../classes/Matcher.html">Matcher</a></li>
            
                <li><a href="../classes/Overlay.html">Overlay</a></li>
            
                <li><a href="../classes/Process.html">Process</a></li>
            
                <li><a href="../classes/Search.html">Search</a></li>
            
                <li><a href="../classes/Select.html">Select</a></li>
            
                <li><a href="../classes/TableView (Datagrid Decorator).html">TableView (Datagrid Decorator)</a></li>
            
                <li><a href="../classes/Tabs.html">Tabs</a></li>
            
                <li><a href="../classes/ThumbnailView (Datagrid Decorator).html">ThumbnailView (Datagrid Decorator)</a></li>
            
                <li><a href="../classes/Toggler.html">Toggler</a></li>
            
                <li><a href="../classes/Toolbar.html">Toolbar</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/husky_components_auto-complete.html">husky/components/auto-complete</a></li>
            
                <li><a href="../modules/husky_components_auto-complete-list.html">husky/components/auto-complete-list</a></li>
            
                <li><a href="../modules/husky_components_column-navigation.html">husky/components/column-navigation</a></li>
            
                <li><a href="../modules/husky_components_column-options.html">husky/components/column-options</a></li>
            
                <li><a href="../modules/husky_components_dropzone.html">husky/components/dropzone</a></li>
            
                <li><a href="../modules/husky_components_input.html">husky/components/input</a></li>
            
                <li><a href="../modules/husky_components_label.html">husky/components/label</a></li>
            
                <li><a href="../modules/husky_components_matcher.html">husky/components/matcher</a></li>
            
                <li><a href="../modules/husky_components_overlay.html">husky/components/overlay</a></li>
            
                <li><a href="../modules/husky_components_process.html">husky/components/process</a></li>
            
                <li><a href="../modules/husky_components_toolbar.html">husky/components/toolbar</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: husky_components/datagrid/decorators/table-view.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
 * @class TableView (Datagrid Decorator)
 * @constructor
 *
 * @param {Object} [viewOptions] Configuration object
 * @param {Boolean} [options.editable] will not set class is-selectable to prevent hover effect for complete rows
 * @param {Boolean} [options.removeRow] displays in the last column an icon to remove a row
 * @param {Object} [options.selectItem] Configuration object of select item (column)
 * @param {Boolean} [options.selectItem.inFirstCell] If true checkbox is in the first cell. If true checkbox gets its own cell
 * @param {String} [options.selectItem.type] Type of select [checkbox, radio]
 * @param {Boolean} [options.validation] enables validation for datagrid
 * @param {Boolean} [options.validationDebug] enables validation debug for datagrid
 * @param {Boolean} [options.addRowTop] adds row to the top of the table when add row is triggered
 * @param {Boolean} [options.startTabIndex] start index for tabindex
 * @param {String} [options.columnMinWidth] sets the minimal width of table columns
 * @param {String} [options.fullWidth] If true datagrid style will be full-width mode
 * @param {Array} [options.excludeFields=[&#x27;id&#x27;]] array of fields to exclude by the view
 * @param {Boolean} [options.showHead] if TRUE head would be showed
 * @param {Array} [options.icons] array of icons to display
 * @param {String} [options.icons[].icon] the actual icon which sould be displayed
 * @param {String} [options.icons[].column] the id of the column in which the icon should be displayed
 * @param {String} [options.icons[].align] the align of the icon. &#x27;left&#x27; org &#x27;right&#x27;
 * @param {Function} [options.icons.callback] a callback to execute if the icon got clicked. Gets the id of the data-record as first argument
 * @param {Boolean} [options.hideChildrenAtBeginning] if true children get hidden, if all children are loaded at the beginning
 * @param {String|Number|Null} [options.openChildId] the id of the children to open all parents for. (only relevant in a child-list)
 * @param {String|Number} [options.cssClass] css-class to give the the components element. (e.g. &quot;white-box&quot;)
 * @param {Boolean} [options.highlightSelected] highlights the clicked row when selected
 *
 * @param {Boolean} [rendered] property used by the datagrid-main class
 * @param {Function} [initialize] function which gets called once at the start of the view
 * @param {Function} [render] function to render data
 * @param {Function} [destroy] function to destroy the view and unbind events
 * @param {Function} [onResize] function which gets automatically executed on window resize
 * @param {Function} [unbindCustomEvents] function to unbind the custom events of this object
 */
define(function() {

    &#x27;use strict&#x27;;

    var defaults = {
            /*editable: false,*/
            /*fullWidth: false,*/
            /*removeRow: false,*/
            selectItem: {
                type: &#x27;checkbox&#x27;,      // checkbox, radio
                inFirstCell: false
            },
            noItemsText: &#x27;This list is empty&#x27;,
            /*validation: false, // TODO does not work for added rows
            validationDebug: false,*/
            /*addRowTop: true,*/
            excludeFields: [&#x27;&#x27;],
            cssClass: &#x27;&#x27;,
            thumbnailFormat: &#x27;50x50&#x27;,
            showHead: true,
            /*hideChildrenAtBeginning: true,*/
            /*openChildId: null,*/
            /*highlightSelected: false,*/
            /*icons: []*/
        },

        constants = {
            skeletonClass: &#x27;husky-table&#x27;,
            containerClass: &#x27;table-container&#x27;,
            overflowClass: &#x27;overflow&#x27;,
            emptyListElementClass: &#x27;empty-list&#x27;,
            cellFitClass: &#x27;fit&#x27;,
            tableClass: &#x27;table&#x27;,
            thumbSrcKey: &#x27;url&#x27;,
            thumbAltKey: &#x27;alt&#x27;
        },

        selectItems = {
            CHECKBOX: &#x27;checkbox&#x27;,
            RADIO: &#x27;radio&#x27;
        },

        /**
         * Templates used by this class
         */
        templates = {
            skeleton: [
                &#x27;&lt;div class=&quot;&#x27;+ constants.skeletonClass +&#x27;&quot;&gt;&#x27;,
                &#x27;   &lt;div class=&quot;&#x27;+ constants.containerClass +&#x27;&quot;&gt;&lt;/div&gt;&#x27;,
                &#x27;&lt;/div&gt;&#x27;
            ].join(&#x27;&#x27;),

            table: &#x27;&lt;table class=&quot;&#x27;+ constants.tableClass +&#x27;&quot;&gt;&lt;/table&gt;&#x27;,
            header: &#x27;&lt;thead&gt;&lt;/thead&gt;&#x27;,
            body: &#x27;&lt;tbody&gt;&lt;/tbody&gt;&#x27;,
            row: &#x27;&lt;tr&gt;&lt;/tr&gt;&#x27;,
            headerCell: &#x27;&lt;th&gt;&lt;/th&gt;&#x27;,
            cell: &#x27;&lt;td&gt;&lt;/td&gt;&#x27;,

            img: &#x27;&lt;img alt=&quot;&lt;%= alt %&gt;&quot; src=&quot;&lt;%= src %&gt;&quot;/&gt;&#x27;,

            checkbox: [
                &#x27;&lt;div class=&quot;custom-checkbox&quot;&gt;&#x27;,
                &#x27;   &lt;input type=&quot;checkbox&quot; data-form=&quot;false&quot;/&gt;&#x27;,
                &#x27;   &lt;span class=&quot;icon&quot;&gt;&lt;/span&gt;&#x27;,
                &#x27;&lt;/div&gt;&#x27;
            ].join(&#x27;&#x27;),

            radio: [
                &#x27;&lt;div class=&quot;custom-radio&quot;&gt;&#x27;,
                &#x27;    &lt;input name=&quot;&lt;%= name %&gt;&quot; type=&quot;radio&quot; data-form=&quot;false&quot;/&gt;&#x27;,
                &#x27;    &lt;span class=&quot;icon&quot;&gt;&lt;/span&gt;&#x27;,
                &#x27;&lt;/div&gt;&#x27;
            ].join(&#x27;&#x27;),

            empty: [
                &#x27;&lt;div class=&quot;&#x27;+ constants.emptyListElementClass +&#x27;&quot;&gt;&#x27;,
                &#x27;   &lt;div class=&quot;fa-coffee icon&quot;&gt;&lt;/div&gt;&#x27;,
                &#x27;   &lt;span&gt;&lt;%= text %&gt;&lt;/span&gt;&#x27;,
                &#x27;&lt;/div&gt;&#x27;
            ].join(&#x27;&#x27;)
        },

        /**
         * used to update the table width and its containers due to responsiveness
         * @event husky.datagrid.update.table
         */
            UPDATE_TABLE = function() {
            return this.datagrid.createEventName.call(this.datagrid, &#x27;update.table&#x27;);
        },

        /**
         * used to update the table width and its containers due to responsiveness
         * @event husky.datagrid.table.open-child
         * @param {Number|String} id The id of the data-record to open the parents for
         */
            OPEN_PARENTS = function() {
            return this.datagrid.createEventName.call(this.datagrid, &#x27;table.open-parents&#x27;);
        },

        /**
         * triggered when a radio button inside the datagrid is clicked
         * @event husky.datagrid.table.open-child
         * @param {Number|String} id The id of the data-record to open the parents for
         * @param {String} columnName column name
         */
            RADIO_SELECTED = function() {
            return this.datagrid.createEventName.call(this.datagrid, &#x27;radio.selected&#x27;);
        },

        /**
         * triggered when children were collapsed
         * @event husky.datagrid.table.children.collapsed
         */
            CHILDREN_COLLAPSED = function() {
            return this.datagrid.createEventName.call(this.datagrid, &#x27;children.collapsed&#x27;);
        },

        /**
         * triggered when children were expanded
         * @event husky.datagrid.table.children.expanded
         */
            CHILDREN_EXPANDED = function() {
            return this.datagrid.createEventName.call(this.datagrid, &#x27;children.expanded&#x27;);
        };

    return {

        /**
         * Initializes the view, gets called only once
         * @param {Object} context The context of the datagrid class
         * @param {Object} options The options used by the view
         */
        initialize: function(context, options) {
            // store context of the datagrid-component
            this.datagrid = context;

            // make sandbox available in this-context
            this.sandbox = this.datagrid.sandbox;

            // merge defaults with options
            this.options = this.sandbox.util.extend(true, {}, defaults, options);

            this.setVariables();
        },

        /**
         * Method to render data in table view
         */
        render: function(data, $container) {
            this.$el = this.sandbox.dom.createElement(templates.skeleton);
            this.sandbox.dom.append($container, this.$el);
            this.sandbox.dom.addClass(this.$el, this.options.cssClass);
            this.data = data;
            this.renderTable();
            if (this.datagrid.options.resizeListeners === true) {
                this.onResize();
            }
            this.rendered = true;
        },

        /**
         * Destroys the view
         */
        destroy: function() {
            this.sandbox.dom.remove(this.$el);
        },

        /**
         * Sets the components starting properties
         */
        setVariables: function() {
            this.rendered = false;
            this.$el = null;
            this.table = {};
            this.data = null;
        },

        /**
         * Render methods (start)
         * -------------------------------------------------------------------- */

        /**
         * Renders the table
         */
        renderTable: function() {
            this.table.$el = this.sandbox.dom.createElement(templates.table);
            if (this.options.showHead === true) {
                this.renderHeader();
            }
            this.renderBody();
            this.sandbox.dom.append(this.sandbox.dom.find(&#x27;.&#x27; + constants.containerClass, this.$el), this.table.$el);
        },

        /**
         * Renders the table header
         */
        renderHeader: function() {
            this.table.header = {};
            this.table.header.$el = this.sandbox.dom.createElement(templates.header);
            this.table.header.$row = this.sandbox.dom.createElement(templates.row);
            if (!!this.options.selectItem &amp;&amp; !!this.options.selectItem.type) {
                this.renderHeaderSelectItem();
            }
            this.renderHeaderCells();
            this.sandbox.dom.append(this.table.header.$el, this.table.header.$row);
            this.sandbox.dom.append(this.table.$el, this.table.header.$el);
        },

        /**
         * Renders the select-all checkbox of the header
         */
        renderHeaderSelectItem: function() {
            var $cell = this.sandbox.dom.createElement(templates.headerCell);
            this.sandbox.dom.addClass($cell, constants.cellFitClass);
            if (this.options.selectItem.type === selectItems.CHECKBOX) {
                this.sandbox.dom.html($cell, templates.checkbox);
            }
            this.sandbox.dom.prepend(this.table.header.$row, $cell);
        },

        /**
         * Renderes the cells in the header
         */
        renderHeaderCells: function() {
            var $headerCell;
            this.table.header.cells = {};

            this.sandbox.util.foreach(this.datagrid.matchings, function(column) {
                $headerCell = this.sandbox.dom.createElement(templates.headerCell);
                this.sandbox.dom.html($headerCell, this.sandbox.translate(column.content));
                this.table.header.cells[column.attribute] = {
                    $el: $headerCell
                };
                this.sandbox.dom.append(this.table.header.$row, this.table.header.cells[column.attribute].$el);
            }.bind(this));
        },

        /**
         * Renders the table body
         */
        renderBody: function() {
            this.table.$body = this.sandbox.dom.createElement(templates.body);
            this.table.rows = {};
            if (this.data.embedded.length &gt; 0) {
                this.sandbox.util.foreach(this.data.embedded, function(record) {
                    this.renderBodyRow(record);
                }.bind(this));
            } else {
                this.renderEmptyIndicator();
            }
            this.sandbox.dom.append(this.table.$el, this.table.$body);
        },

        /**
         * Renderes a single table row
         * @param record {Object} the record
         */
        renderBodyRow: function(record) {
            var $row = this.sandbox.dom.createElement(templates.row);
            this.table.rows[record.id] = {
                $el: $row,
                cells: {}
            };
            if (!!this.options.selectItem &amp;&amp; !!this.options.selectItem.type &amp;&amp; this.options.selectItem.inFirstCell === false) {
                this.renderRowSelectItem(record.id);
            }
            // foreach matching grab the corresponding data and render the cell with it
            this.sandbox.util.foreach(this.datagrid.matchings, function(column) {
                if (this.options.excludeFields.indexOf(column.attribute) === -1) {
                    this.renderBodyCell(record, column);
                }
            }.bind(this));
            this.sandbox.dom.append(this.table.$body, this.table.rows[record.id].$el);
        },

        /**
         * Renderes the checkbox or radio button for a row in the tbody
         * @param id {Number|String} the id of the row to add the select-item for
         */
        renderRowSelectItem: function(id) {
            var $cell = this.sandbox.dom.createElement(templates.cell);
            this.sandbox.dom.addClass($cell, constants.cellFitClass);
            if (this.options.selectItem.type === selectItems.CHECKBOX) {
                this.sandbox.dom.html($cell, templates.checkbox);
            } else if (this.options.selectItem.type === selectItems.RADIO) {
                this.sandbox.dom.html($cell, this.sandbox.util.template(templates.radio)({
                    name: &#x27;datagrid-&#x27; + this.datagrid.options.instanceName
                }));
            }
            this.sandbox.dom.prepend(this.table.rows[id].$el, $cell);
        },

        /**
         * Renders a single cell
         * @param record {Object} the record to render the cell for
         * @param column {Object} the column which should be rendered
         */
        renderBodyCell: function(record, column) {
            var $cell = this.sandbox.dom.createElement(templates.cell),
                content = this.getCellContent(record, column);

            this.sandbox.dom.html($cell, content);

            this.table.rows[record.id].cells[column.attribute] = {
                $el: $cell
            };
            // append cell to corresponding row
            this.sandbox.dom.append(
                this.table.rows[record.id].$el,
                this.table.rows[record.id].cells[column.attribute].$el
            );
        },

        /**
         * Gets the actual content for a cell
         * @param record {Object} the record to get the content for
         * @param column {Object} the column for which the content should be returned
         * @returns {String|Object} the dom object for the cell content or html
         */
        getCellContent: function(record, column) {
            var content = record[column.attribute];
            if (!!column.type &amp;&amp; column.type === this.datagrid.types.THUMBNAILS) {
                content = this.datagrid.manipulateContent(content, column.type, this.options.thumbnailFormat);
                content = this.sandbox.util.template(templates.img)({
                   alt: content[constants.thumbAltKey],
                   src: content[constants.thumbSrcKey]
                });
            } else {
                content = this.datagrid.processContentFilter(
                    column.attribute,
                    content,
                    column.type,
                    Object.keys(this.table.rows).length
                );
            }
            return content;
        },

        /**
         * Renders the empty list element
         */
        renderEmptyIndicator: function() {
            this.sandbox.dom.append(this.$el, this.sandbox.util.template(templates.empty)({
                text: this.sandbox.translate(this.options.noItemsText)
            }));
        },

        /**
         * Render methods (end)
         * -------------------------------------------------------------------- */

        /**
         * Handles the responsiveness
         */
        onResize: function() {
           var $container = this.sandbox.dom.find(&#x27;.&#x27; + constants.containerClass, this.$el),
               isOverflown = this.sandbox.dom.get($container, 0).scrollWidth &gt; this.sandbox.dom.width($container);
            if (isOverflown === true) {
                this.sandbox.dom.addClass(this.$el, constants.overflowClass);
            } else {
                this.sandbox.dom.removeClass(this.$el, constants.overflowClass);
            }
        },

        /**
         * Removes the empty list element
         */
        removeEmptyIndicator: function() {
            this.sandbox.dom.remove(this.sandbox.dom.find(&#x27;.&#x27; + constants.emptyListElementClass, this.$el));
        }
     };
});

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
