<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>husky_components/datagrid/decorators/table-view.js - husky</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title="husky"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.1.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/AutoComplete.html">AutoComplete</a></li>
            
                <li><a href="../classes/AutoCompleteList.html">AutoCompleteList</a></li>
            
                <li><a href="../classes/CKEditor.html">CKEditor</a></li>
            
                <li><a href="../classes/Column-Options.html">Column-Options</a></li>
            
                <li><a href="../classes/ColumnNavigation.html">ColumnNavigation</a></li>
            
                <li><a href="../classes/DataGrid.html">DataGrid</a></li>
            
                <li><a href="../classes/Dependant Select.html">Dependant Select</a></li>
            
                <li><a href="../classes/DropdownPagination (Datagrid Decorator).html">DropdownPagination (Datagrid Decorator)</a></li>
            
                <li><a href="../classes/Dropzone.html">Dropzone</a></li>
            
                <li><a href="../classes/GroupView (Datagrid Decorator).html">GroupView (Datagrid Decorator)</a></li>
            
                <li><a href="../classes/Input.html">Input</a></li>
            
                <li><a href="../classes/Label.html">Label</a></li>
            
                <li><a href="../classes/Loader.html">Loader</a></li>
            
                <li><a href="../classes/Matcher.html">Matcher</a></li>
            
                <li><a href="../classes/Overlay.html">Overlay</a></li>
            
                <li><a href="../classes/Process.html">Process</a></li>
            
                <li><a href="../classes/Search.html">Search</a></li>
            
                <li><a href="../classes/Select.html">Select</a></li>
            
                <li><a href="../classes/TableView (Datagrid Decorator).html">TableView (Datagrid Decorator)</a></li>
            
                <li><a href="../classes/Tabs.html">Tabs</a></li>
            
                <li><a href="../classes/ThumbnailView (Datagrid Decorator).html">ThumbnailView (Datagrid Decorator)</a></li>
            
                <li><a href="../classes/Toggler.html">Toggler</a></li>
            
                <li><a href="../classes/Toolbar.html">Toolbar</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/husky_components_auto-complete.html">husky/components/auto-complete</a></li>
            
                <li><a href="../modules/husky_components_auto-complete-list.html">husky/components/auto-complete-list</a></li>
            
                <li><a href="../modules/husky_components_column-navigation.html">husky/components/column-navigation</a></li>
            
                <li><a href="../modules/husky_components_column-options.html">husky/components/column-options</a></li>
            
                <li><a href="../modules/husky_components_dropzone.html">husky/components/dropzone</a></li>
            
                <li><a href="../modules/husky_components_input.html">husky/components/input</a></li>
            
                <li><a href="../modules/husky_components_label.html">husky/components/label</a></li>
            
                <li><a href="../modules/husky_components_matcher.html">husky/components/matcher</a></li>
            
                <li><a href="../modules/husky_components_overlay.html">husky/components/overlay</a></li>
            
                <li><a href="../modules/husky_components_process.html">husky/components/process</a></li>
            
                <li><a href="../modules/husky_components_toolbar.html">husky/components/toolbar</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: husky_components/datagrid/decorators/table-view.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
 * @class TableView (Datagrid Decorator)
 * @constructor
 *
 * @param {Object} [viewOptions] Configuration object
 * @param {Boolean} [options.editable] will not set class is-selectable to prevent hover effect for complete rows
 * @param {Boolean} [options.removeRow] displays in the last column an icon to remove a row
 * @param {Object} [options.selectItem] Configuration object of select item (column)
 * @param {Boolean} [options.selectItem.inFirstCell] If true checkbox is in the first cell. If true checkbox gets its own cell
 * @param {String} [options.selectItem.type] Type of select [checkbox, radio]
 * @param {Boolean} [options.validation] enables validation for datagrid
 * @param {Boolean} [options.validationDebug] enables validation debug for datagrid
 * @param {Boolean} [options.addRowTop] adds row to the top of the table when add row is triggered
 * @param {Boolean} [options.startTabIndex] start index for tabindex
 * @param {String} [options.columnMinWidth] sets the minimal width of table columns
 * @param {String} [options.fullWidth] If true datagrid style will be full-width mode
 * @param {Array} [options.excludeFields=[&#x27;id&#x27;]] array of fields to exclude by the view
 * @param {Boolean} [options.showHead] if TRUE head would be showed
 * @param {Array} [options.icons] array of icons to display
 * @param {String} [options.icons[].icon] the actual icon which sould be displayed
 * @param {String} [options.icons[].column] the id of the column in which the icon should be displayed
 * @param {String} [options.icons[].align] the align of the icon. &#x27;left&#x27; org &#x27;right&#x27;
 * @param {Function} [options.icons.callback] a callback to execute if the icon got clicked. Gets the id of the data-record as first argument
 * @param {Boolean} [options.hideChildrenAtBeginning] if true children get hidden, if all children are loaded at the beginning
 * @param {String|Number|Null} [options.openChildId] the id of the children to open all parents for. (only relevant in a child-list)
 * @param {String|Number} [options.cssClass] css-class to give the the components element. (e.g. &quot;white-box&quot;)
 * @param {Boolean} [options.highlightSelected] highlights the clicked row when selected
 *
 * @param {Boolean} [rendered] property used by the datagrid-main class
 * @param {Function} [initialize] function which gets called once at the start of the view
 * @param {Function} [render] function to render data
 * @param {Function} [destroy] function to destroy the view and unbind events
 * @param {Function} [onResize] function which gets automatically executed on window resize
 * @param {Function} [unbindCustomEvents] function to unbind the custom events of this object
 */
define(function() {

    &#x27;use strict&#x27;;

    var defaults = {
            editable: false,
            fullWidth: false,
            removeRow: false,
            selectItem: {
                type: &#x27;checkbox&#x27;,      // checkbox, radio
                inFirstCell: false
            },
            noItemsText: &#x27;This list is empty&#x27;,
            addRowTop: true,
            excludeFields: [&#x27;&#x27;],
            cssClass: &#x27;&#x27;,
            thumbnailFormat: &#x27;50x50&#x27;,
            showHead: true,
            /*hideChildrenAtBeginning: true,*/
            /*openChildId: null,*/
            highlightSelected: false,
            /*icons: []*/
        },

        constants = {
            fullWidthClass: &#x27;fullwidth&#x27;,
            selectedRowClass: &#x27;selected&#x27;,
            isSelectableClass: &#x27;is-selectable&#x27;,
            sortableClass: &#x27;is-sortable&#x27;,
            skeletonClass: &#x27;husky-table&#x27;,
            containerClass: &#x27;table-container&#x27;,
            overflowClass: &#x27;overflow&#x27;,
            emptyListElementClass: &#x27;empty-list&#x27;,
            rowRemoverClass: &#x27;row-remover&#x27;,
            checkboxClass: &#x27;checkbox&#x27;,
            radioClass: &#x27;radio&#x27;,
            cellFitClass: &#x27;fit&#x27;,
            tableClass: &#x27;table&#x27;,
            rowClass: &#x27;row&#x27;,
            thumbSrcKey: &#x27;url&#x27;,
            thumbAltKey: &#x27;alt&#x27;,
            removeIcon: &#x27;trash-o&#x27;,
            headerCellClass: &#x27;header-cell&#x27;,
            ascSortedClass: &#x27;sorted-asc&#x27;,
            descSortedClass: &#x27;sorted-desc&#x27;,
            headerCellLoaderClass: &#x27;header-loader&#x27;,
            editableItemClass: &#x27;editable&#x27;,
            editableInputClass: &#x27;editable-input&#x27;,
            inputWrapperClass: &#x27;input-wrapper&#x27;,
            editedErrorClass: &#x27;server-validation-error&#x27;,
            newRecordId: &#x27;newrecord&#x27;
        },

        selectItems = {
            CHECKBOX: &#x27;checkbox&#x27;,
            RADIO: &#x27;radio&#x27;
        },

        /**
         * Templates used by this class
         */
        templates = {
            skeleton: [
                &#x27;&lt;div class=&quot;&#x27;+ constants.skeletonClass +&#x27;&quot;&gt;&#x27;,
                &#x27;   &lt;div class=&quot;&#x27;+ constants.containerClass +&#x27;&quot;&gt;&lt;/div&gt;&#x27;,
                &#x27;&lt;/div&gt;&#x27;
            ].join(&#x27;&#x27;),
            table: &#x27;&lt;table class=&quot;&#x27;+ constants.tableClass +&#x27;&quot;&gt;&lt;/table&gt;&#x27;,
            header: &#x27;&lt;thead&gt;&lt;/thead&gt;&#x27;,
            body: &#x27;&lt;tbody&gt;&lt;/tbody&gt;&#x27;,
            row: &#x27;&lt;tr class=&quot;&#x27; + constants.rowClass + &#x27;&quot;&gt;&lt;/tr&gt;&#x27;,
            headerCell: &#x27;&lt;th class=&quot;&#x27;+ constants.headerCellClass +&#x27;&quot;&gt;&lt;/th&gt;&#x27;,
            cell: &#x27;&lt;td&gt;&lt;/td&gt;&#x27;,
            headerCellLoader: &#x27;&lt;div class=&quot;&#x27;+ constants.headerCellLoaderClass +&#x27;&quot;&gt;&lt;/div&gt;&#x27;,
            removeCellContent: &#x27;&lt;span class=&quot;fa-&#x27; + constants.removeIcon + &#x27; &#x27;+ constants.rowRemoverClass +&#x27;&quot;&gt;&lt;/span&gt;&#x27;,
            editableCellContent: [
                &#x27;&lt;span class=&quot;&#x27;+ constants.editableItemClass +&#x27;&quot;&gt;&lt;%= value %&gt;&lt;/span&gt;&#x27;,
                &#x27;&lt;div class=&quot;&#x27;+ constants.inputWrapperClass +&#x27;&quot;&gt;&#x27;,
                &#x27;   &lt;input type=&quot;text&quot; class=&quot;form-element husky-validate &#x27;+ constants.editableInputClass +&#x27;&quot; value=&quot;&lt;%= value %&gt;&quot;&gt;&#x27;,
                &#x27;&lt;/div&gt;&#x27;
            ].join(&#x27;&#x27;),
            img: &#x27;&lt;img alt=&quot;&lt;%= alt %&gt;&quot; src=&quot;&lt;%= src %&gt;&quot;/&gt;&#x27;,
            checkbox: [
                &#x27;&lt;div class=&quot;custom-checkbox&quot;&gt;&#x27;,
                &#x27;   &lt;input class=&quot;&#x27; + constants.checkboxClass + &#x27;&quot; type=&quot;checkbox&quot; data-form=&quot;false&quot;/&gt;&#x27;,
                &#x27;   &lt;span class=&quot;icon&quot;&gt;&lt;/span&gt;&#x27;,
                &#x27;&lt;/div&gt;&#x27;
            ].join(&#x27;&#x27;),
            radio: [
                &#x27;&lt;div class=&quot;custom-radio&quot;&gt;&#x27;,
                &#x27;    &lt;input class=&quot;&#x27; + constants.radioClass + &#x27;&quot; name=&quot;&lt;%= name %&gt;&quot; type=&quot;radio&quot; data-form=&quot;false&quot;/&gt;&#x27;,
                &#x27;    &lt;span class=&quot;icon&quot;&gt;&lt;/span&gt;&#x27;,
                &#x27;&lt;/div&gt;&#x27;
            ].join(&#x27;&#x27;),
            empty: [
                &#x27;&lt;div class=&quot;&#x27;+ constants.emptyListElementClass +&#x27;&quot;&gt;&#x27;,
                &#x27;   &lt;div class=&quot;fa-coffee icon&quot;&gt;&lt;/div&gt;&#x27;,
                &#x27;   &lt;span&gt;&lt;%= text %&gt;&lt;/span&gt;&#x27;,
                &#x27;&lt;/div&gt;&#x27;
            ].join(&#x27;&#x27;)
        },

        /**
         * used to update the table width and its containers due to responsiveness
         * @event husky.datagrid.update.table
         */
            UPDATE_TABLE = function() {
            return this.datagrid.createEventName.call(this.datagrid, &#x27;update.table&#x27;);
        },

        /**
         * used to update the table width and its containers due to responsiveness
         * @event husky.datagrid.table.open-child
         * @param {Number|String} id The id of the data-record to open the parents for
         */
            OPEN_PARENTS = function() {
            return this.datagrid.createEventName.call(this.datagrid, &#x27;table.open-parents&#x27;);
        },

        /**
         * triggered when a radio button inside the datagrid is clicked
         * @event husky.datagrid.table.open-child
         * @param {Number|String} id The id of the data-record to open the parents for
         * @param {String} columnName column name
         */
            RADIO_SELECTED = function() {
            return this.datagrid.createEventName.call(this.datagrid, &#x27;radio.selected&#x27;);
        },

        /**
         * triggered when children were collapsed
         * @event husky.datagrid.table.children.collapsed
         */
            CHILDREN_COLLAPSED = function() {
            return this.datagrid.createEventName.call(this.datagrid, &#x27;children.collapsed&#x27;);
        },

        /**
         * triggered when children were expanded
         * @event husky.datagrid.table.children.expanded
         */
            CHILDREN_EXPANDED = function() {
            return this.datagrid.createEventName.call(this.datagrid, &#x27;children.expanded&#x27;);
        };

    return {

        /**
         * Public methods used by the main datagrid class (start)
         * -------------------------------------------------------------------- */

        /**
         * Initializes the view, gets called only once
         * @param {Object} context The context of the datagrid class
         * @param {Object} options The options used by the view
         */
        initialize: function(context, options) {
            // store context of the datagrid-component
            this.datagrid = context;

            // make sandbox available in this-context
            this.sandbox = this.datagrid.sandbox;

            // merge defaults with options
            this.options = this.sandbox.util.extend(true, {}, defaults, options);

            this.setVariables();
        },

        /**
         * Method to render data in table view
         */
        render: function(data, $container) {
            this.$el = this.sandbox.dom.createElement(templates.skeleton);
            this.sandbox.dom.append($container, this.$el);
            this.addViewClasses();
            this.data = data;
            this.renderTable();
            this.bindDomEvents();
            if (this.datagrid.options.resizeListeners === true) {
                this.onResize();
            }
            this.rendered = true;
        },

        /**
         * Destroys the view
         */
        destroy: function() {
            this.sandbox.dom.remove(this.$el);
            this.sandbox.stop(&#x27;*&#x27;);
        },

        /**
         * Adds a row to the datagrid
         * @param record {Object} the new record to add
         */
        addRecord: function (record) {
            this.removeEmptyIndicator();
            if (!record.id) {
                record.id = constants.newRecordId;
            }
            this.renderBodyRow(record, this.options.addRowTop);
        },

        /**
         * Removes a record from the view
         * @param recordId {Number|String}
         */
        removeRecord: function(recordId) {
            this.datagrid.removeRecord.call(this.datagrid, recordId);
            this.sandbox.dom.remove(this.table.rows[recordId].$el);
            delete this.table.rows[recordId];
            if (Object.keys(this.table.rows).length === 0) {
                this.toggleSelectAllItem(false);
                this.renderEmptyIndicator();
            }
        },

        /**
         * Handles the responsiveness
         */
        onResize: function() {
            var $container = this.sandbox.dom.find(&#x27;.&#x27; + constants.containerClass, this.$el),
                isOverflown = this.sandbox.dom.get($container, 0).scrollWidth &gt; this.sandbox.dom.width($container);
            if (isOverflown === true) {
                this.sandbox.dom.addClass(this.$el, constants.overflowClass);
            } else {
                this.sandbox.dom.removeClass(this.$el, constants.overflowClass);
            }
        },

        /**
         * Public methods used by the main datagrid class (end)
         * -------------------------------------------------------------------- */

        /**
         * Sets the components starting properties
         */
        setVariables: function() {
            this.rendered = false;
            this.$el = null;
            this.table = {};
            this.data = null;
            this.rowClicked = false;
        },

        /**
         * Adds css classes to the view element
         */
        addViewClasses: function () {
            this.sandbox.dom.addClass(this.$el, this.options.cssClass);
            if (this.options.fullWidth === true) {
                this.sandbox.dom.addClass(this.$el, constants.fullWidthClass);
            }
            if (this.options.highlightSelected === true) {
                this.sandbox.dom.addClass(this.$el, constants.isSelectableClass);
            }
        },

        /**
         * Render methods (start)
         * -------------------------------------------------------------------- */

        /**
         * Renders the table
         */
        renderTable: function() {
            this.table.$el = this.sandbox.dom.createElement(templates.table);
            if (this.options.showHead === true) {
                this.renderHeader();
            }
            this.renderBody();
            this.sandbox.dom.append(this.sandbox.dom.find(&#x27;.&#x27; + constants.containerClass, this.$el), this.table.$el);
        },

        /**
         * Renders the table header
         */
        renderHeader: function() {
            this.table.header = {};
            this.table.header.$el = this.sandbox.dom.createElement(templates.header);
            this.table.header.$row = this.sandbox.dom.createElement(templates.row);
            this.sandbox.dom.append(this.table.header.$el, this.table.header.$row);
            this.renderHeaderSelectItem();
            this.renderHeaderCells();
            this.renderHeaderRemoveItem();
            this.sandbox.dom.append(this.table.$el, this.table.header.$el);
        },

        /**
         * Renders the select-all checkbox of the header
         */
        renderHeaderSelectItem: function() {
            if (!!this.options.selectItem &amp;&amp; !!this.options.selectItem.type) {
                var $cell = this.sandbox.dom.createElement(templates.headerCell);
                this.sandbox.dom.addClass($cell, constants.cellFitClass);
                if (this.options.selectItem.type === selectItems.CHECKBOX) {
                    this.sandbox.dom.html($cell, templates.checkbox);
                }
                this.sandbox.dom.prepend(this.table.header.$row, $cell);
            }
        },

        /**
         * Renderes the cells in the header
         */
        renderHeaderCells: function() {
            var $headerCell;
            this.table.header.cells = {};

            this.sandbox.util.foreach(this.datagrid.matchings, function(column) {
                $headerCell = this.sandbox.dom.createElement(templates.headerCell);
                this.sandbox.dom.html($headerCell, this.sandbox.translate(column.content));
                this.sandbox.dom.data($headerCell, &#x27;attribute&#x27;, column.attribute);
                this.table.header.cells[column.attribute] = {
                    $el: $headerCell,
                    sortable: column.sortable
                };
                this.sandbox.dom.append(this.table.header.$row, this.table.header.cells[column.attribute].$el);
                this.setHeaderCellClasses(column.attribute);
            }.bind(this));
        },

        /**
         * Sets css classes on a header cell
         * @param column {String} the column attribute of the column to set the classes for
         */
        setHeaderCellClasses: function(column) {
            if (this.datagrid.options.sortable === true) {
                var $element = this.table.header.cells[column].$el,
                    sortedClass;
                if (this.table.header.cells[column].sortable === true) {
                    this.sandbox.dom.addClass($element, constants.sortableClass);
                    if (column === this.datagrid.sort.attribute) {
                        sortedClass = (this.datagrid.sort.direction === &#x27;asc&#x27;) ? constants.ascSortedClass : constants.descSortedClass;
                        this.sandbox.dom.addClass($element, sortedClass);
                    }
                }
            }
        },

        /**
         * Renderes an empty remove-row cell into the header
         */
        renderHeaderRemoveItem: function () {
            if (this.options.removeRow === true) {
                var $cell = this.sandbox.dom.createElement(templates.headerCell);
                this.sandbox.dom.addClass($cell, constants.cellFitClass);
                this.sandbox.dom.append(this.table.header.$row, $cell);
            }
        },

        /**
         * Renders the table body
         */
        renderBody: function() {
            this.table.$body = this.sandbox.dom.createElement(templates.body);
            this.table.rows = {};
            if (this.data.embedded.length &gt; 0) {
                this.sandbox.util.foreach(this.data.embedded, function(record) {
                    this.renderBodyRow(record);
                }.bind(this));
            } else {
                this.renderEmptyIndicator();
            }
            this.sandbox.dom.append(this.table.$el, this.table.$body);
        },

        /**
         * Renders the checkbox or radio button for a row in the tbody
         * @param id {Number|String} the id of the row to add the select-item for
         */
        renderRowSelectItem: function(id) {
            if (!!this.options.selectItem &amp;&amp; !!this.options.selectItem.type &amp;&amp; this.options.selectItem.inFirstCell === false) {
                var $cell = this.sandbox.dom.createElement(templates.cell);
                this.sandbox.dom.addClass($cell, constants.cellFitClass);
                if (this.options.selectItem.type === selectItems.CHECKBOX) {
                    this.sandbox.dom.html($cell, templates.checkbox);
                } else if (this.options.selectItem.type === selectItems.RADIO) {
                    this.sandbox.dom.html($cell, this.sandbox.util.template(templates.radio)({
                        name: &#x27;datagrid-&#x27; + this.datagrid.options.instanceName
                    }));
                }
                this.sandbox.dom.prepend(this.table.rows[id].$el, $cell);
            }
        },

        /**
         * Renderes a single table row. If the row already exists it replaces the exiting one
         * @param record {Object} the record
         * @param prepend {Boolean} if true row gets prepended
         */
        renderBodyRow: function (record, prepend) {
            var $row = this.sandbox.dom.createElement(templates.row),
                insertMethod = (prepend === true) ? this.sandbox.dom.prepend : this.sandbox.dom.append,
                $oldElement = (!!this.table.rows[record.id]) ? this.table.rows[record.id].$el : null;
            this.sandbox.dom.data($row, &#x27;id&#x27;, record.id);
            this.table.rows[record.id] = {
                $el: $row,
                cells: {}
            };
            this.renderRowSelectItem(record.id);
            // foreach matching grab the corresponding data and render the cell with it
            this.sandbox.util.foreach(this.datagrid.matchings, function(column) {
                if (this.options.excludeFields.indexOf(column.attribute) === -1) {
                    this.renderBodyCell(record, column);
                }
            }.bind(this));
            this.renderRowRemoveItem(record.id);
            // if there already was a row with the same id, override it with the new one
            if (!!$oldElement &amp;&amp; !!$oldElement.length) {
                this.sandbox.dom.after($oldElement, this.table.rows[record.id].$el);
                this.sandbox.dom.remove($oldElement);
            } else {
                insertMethod(this.table.$body, this.table.rows[record.id].$el);
            }
            if (record.selected === true) {
                this.toggleSelectRecord(record.id, true);
            } else {
                this.toggleSelectAllItem(false);
            }
            // select first input if record is new and editable is true
            if (this.options.editable === true &amp;&amp; record.id === constants.newRecordId) {
                this.showInput(record.id);
            }
        },

        /**
         * Renders the remove item for a row in the tbody
         * @param id {Number|String} the id of the row to add the select-item for
         */
        renderRowRemoveItem: function (id) {
            if (this.options.removeRow === true) {
                var $cell = this.sandbox.dom.createElement(templates.cell);
                this.sandbox.dom.html($cell, templates.removeCellContent);
                this.sandbox.dom.addClass($cell, constants.cellFitClass);
                this.sandbox.dom.append(this.table.rows[id].$el, $cell);
            }
        },

        /**
         * Renders a single cell
         * @param record {Object} the record to render the cell for
         * @param column {Object} the column which should be rendered
         */
        renderBodyCell: function(record, column) {
            var $cell = this.sandbox.dom.createElement(templates.cell),
                content = this.getCellContent(record, column);

            this.sandbox.dom.html($cell, content);
            this.sandbox.dom.data($cell, &#x27;attribute&#x27;, column.attribute);

            this.table.rows[record.id].cells[column.attribute] = {
                $el: $cell,
                originalData: record[column.attribute],
                editable: !!column.editable
            };
            // append cell to corresponding row
            this.sandbox.dom.append(
                this.table.rows[record.id].$el,
                this.table.rows[record.id].cells[column.attribute].$el
            );
        },

        /**
         * Gets the actual content for a cell
         * @param record {Object} the record to get the content for
         * @param column {Object} the column for which the content should be returned
         * @returns {String|Object} the dom object for the cell content or html
         */
        getCellContent: function(record, column) {
            var content = record[column.attribute];
            if (!!column.type &amp;&amp; column.type === this.datagrid.types.THUMBNAILS) {
                content = this.datagrid.manipulateContent(content, column.type, this.options.thumbnailFormat);
                content = this.sandbox.util.template(templates.img)({
                   alt: content[constants.thumbAltKey],
                   src: content[constants.thumbSrcKey]
                });
            } else {
                content = this.datagrid.processContentFilter(
                    column.attribute,
                    content,
                    column.type,
                    Object.keys(this.table.rows).length
                );
            }
            if (this.options.editable === true &amp;&amp; column.editable === true) {
                content = this.getEditableCellContent(content);
            }
            return content;
        },

        /**
         * Takes a string and retruns the markup for an editable cell
         * @param content {String} the original value
         * @returns {String|Object} html or a dom object
         */
        getEditableCellContent: function(content) {
            var returnHTML = this.sandbox.util.template(templates.editableCellContent)({
                value: content
            });
            return returnHTML;
        },

        /**
         * Renders the empty list element
         */
        renderEmptyIndicator: function() {
            this.sandbox.dom.append(this.$el, this.sandbox.util.template(templates.empty)({
                text: this.sandbox.translate(this.options.noItemsText)
            }));
        },

        /**
         * Render methods (end)
         * -------------------------------------------------------------------- */

        /**
         * Bindes dom related events
         */
        bindDomEvents: function () {
            // select or deselect items if the body recognizes a change event
            this.sandbox.dom.on(
                this.table.$body, &#x27;click&#x27;, this.selectItemChangeHandler.bind(this),
                &#x27;.&#x27; + constants.checkboxClass + &#x27;, .&#x27; + constants.radioClass
            );
            // handle click on body row
            this.sandbox.dom.on(this.table.$body, &#x27;click&#x27;, this.bodyRowClickHandler.bind(this), &#x27;.&#x27; + constants.rowClass);
            // remove row event
            if (this.options.removeRow === true) {
                this.sandbox.dom.on(this.table.$body, &#x27;click&#x27;, this.removeItemClickHandler.bind(this), &#x27;.&#x27; + constants.rowRemoverClass);
            }
            if (!!this.table.header) {
                // select all
                this.sandbox.dom.on(this.table.header.$el, &#x27;change&#x27;, this.allSelectItemChangeHandler.bind(this));

                // click on sortable item
                if (this.datagrid.options.sortable === true) {
                    this.sandbox.dom.on(
                        this.table.header.$el, &#x27;click&#x27;, this.sortItemClickHandler.bind(this),
                        &#x27;.&#x27; + constants.headerCellClass + &#x27;.&#x27; + constants.sortableClass
                    );
                }
            }
            // click on editable item
            if (this.options.editable === true) {
                this.sandbox.dom.on(this.table.$body, &#x27;click&#x27;, this.editableItemClickHandler.bind(this), &#x27;.&#x27; + constants.editableItemClass);
                this.sandbox.dom.on(this.table.$body, &#x27;focusout&#x27;, this.editableInputFocusoutHandler.bind(this), &#x27;.&#x27; + constants.editableInputClass);
            }
        },

        /**
         * Handles the click on a sortable item
         * @param event {Object} the event object
         */
        sortItemClickHandler: function(event) {
            this.sandbox.dom.stopPropagation(event);
            var attribute = this.sandbox.dom.data(event.currentTarget, &#x27;attribute&#x27;),
                direction = &#x27;asc&#x27;;
            if (this.datagrid.sort.attribute === attribute &amp;&amp; this.datagrid.sort.direction === direction) {
                direction = &#x27;desc&#x27;;
            }
            this.startHeaderCellLoader(attribute);
            // delegate sorting to datagrid
            this.datagrid.sortGrid.call(this.datagrid, attribute, direction);
        },

        /**
         * Handles the click on an editable item
         * @param event {Object} the event object
         */
        editableItemClickHandler: function(event) {
            this.sandbox.dom.stopPropagation(event);
            var recordId = this.sandbox.dom.data(this.sandbox.dom.parents(event.currentTarget, &#x27;.&#x27; + constants.rowClass), &#x27;id&#x27;),
                attribute = this.sandbox.dom.data(this.sandbox.dom.parents(event.currentTarget, &#x27;td&#x27;), &#x27;attribute&#x27;);
            this.showInput(recordId, attribute);
        },

        /**
         * Shows a edit-input for a row and an attribute if no attribute passed shows the first input in row
         * @param recordId {Number|String}
         * @param attribute {String}
         */
        showInput: function(recordId, attribute) {
            var $cell, $inputs;
            if (!attribute) {
                $inputs = this.sandbox.dom.find(&#x27;.&#x27; + constants.editableInputClass, this.table.rows[recordId].$el);
                attribute = this.sandbox.dom.data(this.sandbox.dom.parents($inputs[0], &#x27;td&#x27;), &#x27;attribute&#x27;);
            }
            $cell = this.table.rows[recordId].cells[attribute].$el
            this.sandbox.dom.show(this.sandbox.dom.find(&#x27;.&#x27; + constants.inputWrapperClass, $cell));
            this.sandbox.dom.select(this.sandbox.dom.find(&#x27;.&#x27; + constants.editableInputClass, $cell));
        },

        /**
         * Handles the focusout of an editable input
         * @param event {Object} the event object
         */
        editableInputFocusoutHandler: function (event) {
            this.sandbox.dom.stopPropagation(event);
            var recordId = this.sandbox.dom.data(this.sandbox.dom.parents(event.currentTarget, &#x27;.&#x27; + constants.rowClass), &#x27;id&#x27;),
                modifiedRecord = {};
            // build new record object out of the inputs in the row
            this.sandbox.util.each(this.table.rows[recordId].cells, function (attribute, cell) {
                if (!!this.sandbox.dom.find(&#x27;.&#x27; + constants.editableInputClass, cell.$el).length) {
                    modifiedRecord[attribute] = this.sandbox.dom.val(
                        this.sandbox.dom.find(&#x27;.&#x27; + constants.editableInputClass, cell.$el)
                    );
                }
            }.bind(this));
            this.saveRow(recordId, modifiedRecord, this.editedSuccessCallback.bind(this), this.editedErrorCallback.bind(this, recordId));
        },

        /**
         * Clears everything up after a row was edited. (hides the input and updates the values)
         * @param record {Object} the changed data record
         */
        editedSuccessCallback: function (record) {
            var $row;
            if (!!record.id) {
                $row = this.table.rows[record.id].$el
            } else if (!!this.table.rows[constants.newRecordId]) {
                $row = this.table.rows[constants.newRecordId].$el
            }
            if (!!$row &amp;&amp; !!$row.length) {
                this.sandbox.dom.hide(this.sandbox.dom.find(&#x27;.&#x27; + constants.inputWrapperClass, $row));
                // if a &quot;new&quot; row exists remove it
                if (!!this.table.rows[constants.newRecordId]) {
                    this.sandbox.dom.remove(this.table.rows[constants.newRecordId].$el);
                }
                this.renderBodyRow(record, this.options.addRowTop);
            }
        },

        /**
         * Adds a css class to all inputs in a row, if the editing request returned with an error
         * @param recordId
         */
        editedErrorCallback: function (recordId) {
            var $row = this.table.rows[recordId].$el;
            this.sandbox.dom.addClass(
                this.sandbox.dom.find(&#x27;.&#x27; + constants.inputWrapperClass, $row),
                constants.editedErrorClass
            );
        },

        /**
         * Replaces a record with an existing one and sends it to a server
         * @param recordId {Number|String} the id of the record to override
         * @param newRecordData {Object} the new record data
         * @param successCallback {Function} gets executed after success
         * @param errorCallback {Function} gets executed after error
         */
        saveRow: function (recordId, newRecordData, successCallback, errorCallback) {
            var hasChanged = false,
                record;
            this.sandbox.util.each(this.table.rows[recordId].cells, function (attribute, cell) {
                if (cell.editable === true &amp;&amp; cell.originalData !== newRecordData[attribute]) {
                    hasChanged = true;
                }
            }.bind(this));
            // merge record data
            record = this.sandbox.util.extend(true, {}, this.data.embedded[this.datagrid.getRecordIndexById(recordId)]);
            if (recordId === constants.newRecordId) {
                delete record.id;
            }
            if (hasChanged === true) {
                // pass data to datagrid to save it
                this.datagrid.saveGrid.call(this.datagrid,
                    record, this.datagrid.getUrlWithoutParams.call(this.datagrid),
                    successCallback, errorCallback, this.options.addRowTop);
            } else {
                typeof successCallback === &#x27;function&#x27; &amp;&amp; successCallback(record);
            }
        },

        /**
         * Starts a loader in a cell in the header
         * @param column {String} the attribute of the header cell to insert the loader in
         */
        startHeaderCellLoader: function(column) {
            var $container = this.sandbox.dom.createElement(templates.headerCellLoader);
            this.sandbox.dom.append(this.table.header.cells[column].$el, $container);
            this.sandbox.start([
                {
                    name: &#x27;loader@husky&#x27;,
                    options: {
                        el: $container,
                        size: &#x27;10px&#x27;,
                        color: &#x27;#999999&#x27;
                    }
                }
            ]);
        },

        /**
         * Handles the click on a body row
         * @param event {Object} the event object
         */
        bodyRowClickHandler: function (event) {
            this.sandbox.dom.stopPropagation(event);
            var recordId = this.sandbox.dom.data(event.currentTarget, &#x27;id&#x27;);
            this.emitRowClickedEvent(event);
            if (this.options.highlightSelected === true) {
                this.uniqueHighlightRecord(recordId);
            }
        },

        /**
         * Emits the row clicked event
         * @param event {Object} the original click event
         */
        emitRowClickedEvent: function (event) {
            if (this.rowClicked === false) {
                this.rowClicked = true;
                var recordId = this.sandbox.dom.data(event.currentTarget, &#x27;id&#x27;),
                    parameter = recordId || event;
                this.datagrid.emitItemClickedEvent.call(this.datagrid, parameter);
                // delay to prevent multiple emits on double click
                this.sandbox.util.delay(function () {
                    this.rowClicked = false;
                }.bind(this), 500);
            }
        },

        /**
         * Handles the click on the remove item
         * @param event {Object} the event object
         */
        removeItemClickHandler: function(event) {
            this.sandbox.dom.stopPropagation(event);
            var recordId = this.sandbox.dom.data(this.sandbox.dom.parents(event.currentTarget, &#x27;.&#x27; + constants.rowClass), &#x27;id&#x27;);
            this.removeRecord(recordId);
        },

        /**
         * Handles the change event of the select items
         * @param event {Object} the event object
         */
        selectItemChangeHandler: function (event) {
            this.sandbox.dom.stopPropagation(event);
            var recordId = this.sandbox.dom.data(this.sandbox.dom.parents(event.target, &#x27;.&#x27; + constants.rowClass), &#x27;id&#x27;),
                isChecked = this.sandbox.dom.is(event.target, &#x27;:checked&#x27;);
            if (this.options.selectItem.type === selectItems.CHECKBOX) {
                this.toggleSelectRecord(recordId, isChecked);
            } else if (this.options.selectItem.type === selectItems.RADIO) {
                this.uniqueSelectRecord(recordId);
            }
        },

        /**
         * Handles the change event of a select item in the header
         * @param event {Object} the event object
         */
        allSelectItemChangeHandler: function (event) {
            this.sandbox.dom.stopPropagation(event);
            var isChecked = this.sandbox.dom.is(event.target, &#x27;:checked&#x27;);
            if (isChecked === true) {
                this.selectAllRecords();
            } else {
                this.deselectAllRecords();
            }
        },

        /**
         * Highlights a record an unhighlights all other rows
         * @param id {Number|String} the id of the record to highlight
         */
        uniqueHighlightRecord: function (id) {
            this.sandbox.dom.removeClass(
                this.sandbox.dom.find(&#x27;.&#x27; + constants.rowClass + &#x27;.&#x27; + constants.selectedRowClass, this.table.$body),
                constants.selectedRowClass
            );
            this.sandbox.dom.addClass(this.table.rows[id].$el, constants.selectedRowClass);
        },

        /**
         * Selejcts all records
         */
        selectAllRecords: function () {
            this.datagrid.selectAllItems.call(this.datagrid);
            this.sandbox.dom.prop(this.sandbox.dom.find(&#x27;.&#x27; + constants.checkboxClass, this.table.$body), &#x27;checked&#x27;, true);
        },

        /**
         * Deselects all records
         */
        deselectAllRecords: function () {
            this.datagrid.deselectAllItems.call(this.datagrid);
            this.sandbox.dom.prop(this.sandbox.dom.find(&#x27;.&#x27; + constants.checkboxClass, this.table.$body), &#x27;checked&#x27;, false);
        },

        /**
         * Selects or deselects a record with a given id
         * @param id {Number|String} the id of the record to select or deselect
         * @param select {Boolean} true to select false to deselect
         */
        toggleSelectRecord: function (id, select) {
            var areAllSelected;
            if (select === true) {
                this.datagrid.setItemSelected.call(this.datagrid, id);
                // ensure that checkboxes are checked
                this.sandbox.dom.prop(
                    this.sandbox.dom.find(&#x27;.&#x27; + constants.checkboxClass, this.table.rows[id].$el), &#x27;checked&#x27;, true
                );
            } else {
                this.datagrid.setItemUnselected.call(this.datagrid, id);
                // ensure that checkboxes are unchecked
                this.sandbox.dom.prop(
                    this.sandbox.dom.find(&#x27;.&#x27; + constants.checkboxClass, this.table.rows[id].$el), &#x27;checked&#x27;, false
                );
            }
            // check or uncheck checkboxes in the header
            if (!!this.table.header) {
                areAllSelected = this.datagrid.getSelectedItemIds.call(this.datagrid).length === this.data.embedded.length;
                this.toggleSelectAllItem(areAllSelected);
            }
        },

        /**
         * Selects or deselects the select all item
         * @param select {Boolean} true to select false to deselect the select all item
         */
        toggleSelectAllItem: function (select) {
            if (!!this.table.header) {
                this.sandbox.dom.prop(
                    this.sandbox.dom.find(&#x27;.&#x27; + constants.checkboxClass, this.table.header.$el), &#x27;checked&#x27;, select
                );
            }
        },

        /**
         * Selects a record and deselects all other records
         * @param id {Number|String} the id of the record to select
         */
        uniqueSelectRecord: function (id) {
            this.datagrid.deselectAllItems.call(this.datagrid);
            this.datagrid.setItemSelected.call(this.datagrid, id);
        },

        /**
         * Removes the empty list element
         */
        removeEmptyIndicator: function() {
            this.sandbox.dom.remove(this.sandbox.dom.find(&#x27;.&#x27; + constants.emptyListElementClass, this.$el));
        }
     };
});

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
