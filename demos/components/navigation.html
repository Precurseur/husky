<!doctype html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title></title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width">
    <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
    <link rel="stylesheet" href="../../.tmp/husky.css">
</head>
<body>
    <div id="main">
        <div id="navigation"></div>
    </div>

    <script src="../../node_modules/sinon/pkg/sinon.js"></script>
    <script src="../../bower_components/jquery/jquery.js"></script>
    
    <script src="../../js/husky.js"></script>
    <script src="../../js/modules/util.js"></script>
    <script src="../../js/modules/ui.navigation.js"></script>

    <script type="text/javascript">
        Husky.DEBUG = true;

        var server;
        $(document).ready(function() {
            server = sinon.fakeServer.create();

            // server.respondWith('GET', 'navigation', [200, { 'Content-Type': 'application/json' },
            //     '{ "entries": [{ "title": "Hallo", "id": "test",  "hasChildren": "true", "action": "test", "sub": { "entries": [{ "title": "Products", "hasChildren": "true", "action": "products" }, { "title": "Products", "hasChildren": "true", "action": "products" }, { "title": "Products", "hasChildren": "true", "action": "products" }, { "title": "Products", "hasChildren": "true", "action": "products" }, { "title": "Products", "hasChildren": "true", "action": "products" }] } }, { "title": "Voll deutsch", "id": "boom", "action": "dashboard", "hasChildren": "true" }] }'
            // ]);

            server.respondWith('GET', 'navigation', [200, { 'Content-Type': 'application/json' },
                '{"title":"Root","hasChildren": true,"id":"51efc3a54f881","sub":{"entries":[{"title":"Settings","hasChildren": true,"id":"51efc3a54f89a","sub":{"entries":[{"title":"Translate","hasChildren":false,"id":"51efc3a54f8b0"}]}}]}}'
            ]);

            server.respondWith('GET', 'navigation/dashboard', [200, { 'Content-Type': 'application/json' },
                '{ "entries": [{ "title": "Products", "id": "products", "hasChildren": "true", "uri": "products" }, { "title": "Products", "id": "products", "hasChildren": "true", "uri": "products" }, { "title": "Products", "id": "products", "hasChildren": "true", "uri": "products" }, { "title": "Products", "id": "products", "hasChildren": "true", "uri": "products" }, { "title": "Products", "id": "products", "hasChildren": "true", "uri": "products" }, { "title": "Products", "id": "products", "hasChildren": "true", "uri": "products" }, { "title": "Products", "id": "products", "hasChildren": "true", "uri": "products" }, { "title": "Products", "id": "products", "hasChildren": "true", "uri": "products" }, { "title": "Products", "id": "products", "hasChildren": "true", "uri": "products" }, { "title": "Products", "id": "products", "hasChildren": "true", "uri": "products" }, { "title": "Products", "id": "products", "hasChildren": "true", "uri": "products" }, { "title": "Products", "id": "products", "hasChildren": "true", "uri": "products" }, { "title": "Products", "id": "products", "hasChildren": "true", "uri": "products" }, { "title": "Products", "id": "products", "hasChildren": "true", "uri": "products" }, { "title": "Products", "id": "products", "hasChildren": "true", "uri": "products" }, { "title": "Products", "id": "products", "hasChildren": "true", "uri": "products" }, { "title": "Products", "id": "products", "hasChildren": "true", "uri": "products" }, { "title": "Products", "id": "products", "hasChildren": "true", "uri": "products" }, { "title": "Products", "id": "products", "hasChildren": "true", "uri": "products" }, { "title": "Contact", "id": "contact", "hasChildren": "true", "uri": "contact" }] }'
            ]);

            server.respondWith('GET', 'navigation/portals', [200, { 'Content-Type': 'application/json' },
                '{ "entries": [{ "title": "Deutschland", "id": "de", "hasChildren": "true", "uri": "portals/de" }, { "title": "Schweiz", "id": "ch", "hasChildren": "true", "uri": "contact" }] }'
            ]);

            server.respondWith('GET', 'navigation/portals/de', [200, { 'Content-Type': 'application/json' },
                '{ "entries": [{ "title": "Land der Deutschen", "id": "land_deutschen", "hasChildren": "true", "uri": "portals/de/land_deutschen" }, { "title": "Voll deutsch", "id": "boom", "hasChildren": "true", "uri": "contact" }] }'
            ]);

            server.respondWith('GET', 'navigation/portals/de/land_deutschen', [200, { 'Content-Type': 'application/json' },
                '{ "entries": [{ "title": "Hallo", "id": "hallo", "hasChildren": "true", "uri": "portals/de/land_deutschen/hallo" }, { "title": "Voll deutsch", "id": "boom", "hasChildren": "true", "uri": "contact" }] }'
            ]);

            server.respondWith('GET', 'navigation/portals/de/land_deutschen/hallo', [200, { 'Content-Type': 'application/json' },
                '{ "entries": [{ "title": "Tschau", "id": "de", "hasChildren": "true", "uri": "test" }, { "title": "Voll deutsch", "id": "boom", "hasChildren": "true", "uri": "contact" }] }'
            ]);

            var navigation = $('#navigation').huskyNavigation({
                url: 'navigation',
                collapse: true
            });

            navigation.data('Husky.Ui.Navigation').on('navigation:entry:select', function() {
                setTimeout(function() {
                    server.respond();
                }, 100);
            });

            server.respond();
        });
    </script>

</body>
</html>
